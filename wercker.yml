box: ruby

build:
  steps:
    - install-packages:
        packages: nodejs

    - script:
        name: config bundler
        code: bundle config build.nokogiri --use-system-libraries

    - bundle-install

    # A custom script step
    # that actually builds the jekyll site
    - script:
        name: generate site
        code: bundle exec jekyll build --trace
deploy:
  steps:
    - s3sync:
        key-id: $S3_KEY
        key-secret: $S3_SECRET
        bucket-url: $S3_BUCKET
        source-dir: _site/
        opts: -v --acl-public --cf-invalidate
